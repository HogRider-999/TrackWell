<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TrackWell</title>
    <link rel="stylesheet" href="style.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <link rel="manifest" href="manifest.json">
    <meta name="theme-color" content="#d88210">
</head>
<body>
    <div id="auth-screen" class="auth-overlay">
        <div class="auth-card">
            <div class="logo">TrackWell</div>
            <p data-i18n="loginSub">請輸入您的名字以進入系統</p>
            <input type="text" id="auth-username" data-i18n="loginInput" placeholder="您的名字..." class="auth-input">
            <button class="btn-create auth-btn" onclick="performLogin()">
                <span data-i18n="btnLogin">進入系統</span>
            </button>
        </div>
    </div>

    <div class="app-container" id="app">
        <div class="sidebar-overlay" onclick="toggleSidebar()"></div>
        <aside class="sidebar">
            <div class="logo">TrackWell</div>
            <nav class="menu">
                <ul>
                    <li class="nav-item active" onclick="showPage('home', this)">
                        <i class="fas fa-home"></i> 
                        <span data-i18n="navHome">首頁</span>
                    </li>
                    <li class="nav-item" onclick="showPage('workout', this)">
                        <i class="fas fa-dumbbell"></i> 
                        <span data-i18n="navWorkout">訓練計畫</span>
                    </li>
                    <li class="nav-item" onclick="showPage('diet', this)">
                        <i class="fas fa-utensils"></i> 
                        <span data-i18n="navDiet">飲食紀錄</span>
                    </li>
                    <li class="nav-item" onclick="showPage('pomodoro-page', this)">
                        <i class="fas fa-clock"></i> 
                        <span data-i18n="navPomo">計時器</span>
                    </li>
                    <li class="nav-item" onclick="showPage('stats', this)">
                        <i class="fas fa-chart-line"></i> 
                        <span data-i18n="navStats">數據分析</span>
                    </li>
                    <li class="nav-item" onclick="showPage('settings', this)">
                        <i class="fas fa-cog"></i> 
                        <span data-i18n="navSettings">設定</span>
                    </li>
                </ul>
            </nav>
            <div class="sidebar-exam-card" onclick="openModal('countdown-settings-modal')">
                <div class="exam-label" id="side-countdown-label">2026 統測倒數</div>
                <div class="exam-days" id="exam-days">--</div>
                <div class="exam-sub"><span data-i18n="sideExamSub">點擊設定目標</span></div>
            </div>
        </aside>

        <main class="main-view">
            <header class="top-bar">
                <div class="left-controls">
                    <i class="fas fa-bars sidebar-toggle" onclick="toggleSidebar()"></i>
                    <div class="search">
                        <i class="fas fa-search"></i>
                        <input type="text" data-i18n="topSearch" placeholder="搜尋功能...">
                    </div>
                </div>
                <div class="profile">
                    <span class="user-stats" id="top-user-stats">160cm | 62.0kg</span>
                    <i class="fas fa-user-circle"></i>
                </div>
            </header>

            <div id="content-area">
                <section id="home" class="page active">
                    <div class="hero-banner-lg">
                        <div class="hero-txt">
                            <h1 class="gradient-text" id="home-title"></h1>
                            <p id="home-quote"><span></span></p>
                        </div>
                    </div>
                    <div class="dashboard-grid-lg">
                        <div class="dash-card-lg card-small pointer-card" onclick="openModal('steps-settings-modal')">
                            <div class="card-icon-header">
                                <h3><span data-i18n="stepsTitle">今日步數</span></h3>
                                <i class="fas fa-shoe-prints"></i>
                            </div>
                            <div class="val" id="home-steps-val">0</div>
                            <div class="bar-outer">
                                <div id="home-steps-bar" class="bar-inner" style="width: 0%;"></div>
                            </div>
                        </div>
                        <div class="dash-card-lg card-small pointer-card" onclick="openModal('cal-goal-modal')">
                            <div class="card-icon-header">
                                <h3><span data-i18n="intakeTitle">攝取進度</span></h3>
                                <i class="fas fa-fire"></i>
                            </div>
                            <div class="circle-box-lg">
                                <svg viewBox="0 0 36 36" class="circular-chart-lg orange">
                                    <path class="circle-bg" d="M18 2.0845 a 15.9155 15.9155 0 0 1 0 31.831 a 15.9155 15.9155 0 0 1 0 -31.831" />
                                    <path id="home-cal-circle" class="circle" stroke-dasharray="0, 100" d="M18 2.0845 a 15.9155 15.9155 0 0 1 0 31.831 a 15.9155 15.9155 0 0 1 0 -31.831" />
                                </svg>
                                <div class="percentage-content">
                                    <span class="percentage-lg" id="home-cal-val">0</span>
                                    <span class="unit-lg">kcal</span>
                                </div>
                            </div>
                        </div>
                        <div class="dash-card-lg weight-focus-card pointer-card" onclick="openModal('body-input-modal')">
                            <div class="weight-header">
                                <h3><i class="fas fa-weight"></i> <span data-i18n="weightTitle">體重目標進度</span></h3>
                                <span class="status-badge" id="home-goal-badge">增肌中</span>
                            </div>
                            <div class="weight-body">
                                <div class="w-current">
                                    <span data-i18n="weightCurrent">目前</span>
                                    <strong id="home-weight-display">--<small>kg</small></strong>
                                </div>
                                <div class="w-divider"><i class="fas fa-angle-double-right"></i></div>
                                <div class="w-goal">
                                    <span data-i18n="weightGoal">目標</span>
                                    <strong id="home-goal-weight">--<small>kg</small></strong>
                                </div>
                            </div>
                            <div class="w-progress-container">
                                <div class="w-progress-track">
                                    <div id="home-weight-bar" class="w-progress-fill" style="width: 0%;"></div>
                                </div>
                                <div class="w-progress-labels">
                                    <span id="home-weight-start">起始: --kg</span>
                                    <span id="home-weight-dist">距離目標: --kg</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </section>

                <section id="pomodoro-page" class="page">
                    <div class="timer-page-grid">
                        <div class="timer-block-side">
                            <h2 class="gradient-text"><i class="fas fa-clock"></i> <span data-i18n="pomoTitle">番茄鐘專注</span></h2>
                            <div class="pomo-compact">
                                <div class="pomo-circle-sm">
                                    <svg viewBox="0 0 100 100">
                                        <circle class="pomo-bg" cx="50" cy="50" r="45"></circle>
                                        <circle id="pomo-progress" class="pomo-bar" cx="50" cy="50" r="45"></circle>
                                    </svg>
                                    <div class="timer-display-sm" id="main-timer">25:00</div>
                                </div>
                                <div class="timer-controls-sm">
                                    <button class="ctrl-btn-sm play" id="pomo-play-btn" onclick="togglePomodoro()">
                                        <i class="fas fa-play" id="pomo-play-icon"></i>
                                    </button>
                                    <button class="ctrl-btn-sm reset" onclick="resetPomodoro()">
                                        <i class="fas fa-undo"></i>
                                    </button>
                                </div>
                                <div class="pomo-modes-sm">
                                    <button class="sm-mode active" onclick="setTimerMode(25)">25m</button>
                                    <button class="sm-mode" onclick="setTimerMode(5)">5m</button>
                                    <button class="sm-mode" onclick="setTimerMode(15)">15m</button>
                                </div>
                            </div>
                            <div class="todo-section">
                                <h3><i class="fas fa-list-ul"></i> <span data-i18n="pomoTaskTitle">今日任務</span></h3>
                                <div class="todo-input-row">
                                    <input type="text" id="todo-input" data-i18n="pomoInput" placeholder="新增待辦事項...">
                                    <button onclick="addTodo()"><i class="fas fa-plus"></i></button>
                                </div>
                                <ul id="todo-list" class="todo-list"></ul>
                            </div>
                        </div>
                        <div class="timer-block-side">
                            <h2 class="gradient-text"><i class="fas fa-stopwatch"></i> <span data-i18n="customTimerTitle">自訂計時器</span></h2>
                            <div class="custom-timer-container">
                                <div class="custom-timer-display" id="custom-timer-display">00:00:00</div>
                                <div class="timer-input-group" id="ct-inputs">
                                    <div class="t-input">
                                        <input type="number" id="ct-h" value="0" min="0" max="23">
                                        <span data-i18n="timeH">時</span>
                                    </div>
                                    <div class="t-input">
                                        <input type="number" id="ct-m" value="0" min="0" max="59">
                                        <span data-i18n="timeM">分</span>
                                    </div>
                                    <div class="t-input">
                                        <input type="number" id="ct-s" value="0" min="0" max="59">
                                        <span data-i18n="timeS">秒</span>
                                    </div>
                                </div>
                                <div class="timer-controls-row">
                                    <button class="timer-btn primary" id="ct-start-btn" onclick="toggleCustomTimer()">
                                        <span id="ct-start-text" data-i18n="ctStart">開始</span>
                                    </button>
                                    <button class="timer-btn secondary" onclick="resetCustomTimer()">
                                        <span data-i18n="ctReset">重置</span>
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                </section>

                <section id="workout" class="page">
                    <div id="workout-home">
                        <div class="section-header-lg">
                            <h2 class="gradient-text"><span data-i18n="workoutTitle">專屬訓練課表</span></h2>
                            <p class="meta-desc-lg"><span data-i18n="workoutSub">點擊卡片開啟訓練模式，或建立新計畫</span></p>
                        </div>
                        <div class="workout-grid-lg" id="workout-card-grid"></div>
                    </div>
                    <div id="workout-detail" style="display:none">
                        <div class="detail-top-nav">
                            <button class="back-modern-btn" onclick="backToWorkoutHome()">
                                <i class="fas fa-arrow-left"></i> <span data-i18n="btnBack">返回選擇</span>
                            </button>
                        </div>
                        <div class="detail-header-lg">
                            <img id="detail-cover" class="detail-img-lg" src="">
                            <div class="detail-info-lg">
                                <p class="type-tag">TRAINING MODE</p>
                                <h1 id="current-day-title">今日訓練</h1>
                                <div class="detail-meta-lg">
                                    <span class="author"><span data-i18n="wAuthor">自訂課表</span></span> • 
                                    <span class="stats-txt" id="workout-target-txt">目標: 增肌</span>
                                </div>
                            </div>
                        </div>
                        <div class="tracklist-container">
                            <div class="tracklist-header-lg">
                                <span>#</span>
                                <span><span data-i18n="wHeadTitle">標題</span></span>
                                <span><span data-i18n="wHeadSet">組數 / 重量</span></span>
                                <span><span data-i18n="wHeadStatus">狀態</span></span>
                            </div>
                            <div id="exercise-list-container" class="list-container"></div>
                        </div>
                    </div>
                </section>

                <section id="diet" class="page">
                    <div class="section-header-lg" style="display: flex; justify-content: space-between; align-items: flex-end;">
                        <div>
                            <h2 class="gradient-text"><span data-i18n="dietTitle">飲食紀錄</span></h2>
                            <p class="meta-desc-lg"><span data-i18n="dietSub">精準掌握熱量與三大營養素</span></p>
                        </div>
                        <div class="meal-actions">
                            <button class="ai-scan-btn activity-btn" onclick="openModal('activity-input-modal')">
                                <i class="fas fa-running"></i> <span data-i18n="dietActivity">新增活動</span>
                            </button>
                            <button class="ai-scan-btn" onclick="openModal('manual-food-modal')">
                                <i class="fas fa-pen"></i> <span data-i18n="dietManual">手動輸入</span>
                            </button>
                            <button class="ai-scan-btn ai-btn-outline" onclick="openModal('ai-scan-modal')">
                                <i class="fas fa-camera"></i> <span data-i18n="dietAI">AI 辨識</span>
                            </button>
                        </div>
                    </div>
                    <div class="diet-summary-section">
                        <div class="cal-main-card">
                            <div class="cal-circle-wrapper">
                                <svg viewBox="0 0 36 36" class="circular-chart-lg green">
                                    <path class="circle-bg" d="M18 2.0845 a 15.9155 15.9155 0 0 1 0 31.831 a 15.9155 15.9155 0 0 1 0 -31.831" />
                                    <path id="diet-cal-circle" class="circle" stroke-dasharray="0, 100" d="M18 2.0845 a 15.9155 15.9155 0 0 1 0 31.831 a 15.9155 15.9155 0 0 1 0 -31.831" />
                                </svg>
                                <div class="cal-center-text">
                                    <span class="remain-val" id="cal-remaining">0</span>
                                    <span class="remain-lbl"><span data-i18n="remain">剩餘 (kcal)</span></span>
                                </div>
                            </div>
                            <div class="cal-stats-row">
                                <div class="cal-stat-item">
                                    <span class="stat-lbl"><span data-i18n="goal">目標</span></span>
                                    <strong class="stat-val" id="diet-goal-val">2600</strong>
                                </div>
                                <div class="cal-stat-operator">-</div>
                                <div class="cal-stat-item">
                                    <span class="stat-lbl"><span data-i18n="intake">已攝取</span></span>
                                    <strong class="stat-val text-primary" id="cal-intake">0</strong>
                                </div>
                                <div class="cal-stat-operator">+</div>
                                <div class="cal-stat-item">
                                    <span class="stat-lbl"><span data-i18n="burn">運動消耗</span></span>
                                    <strong class="stat-val text-green" id="cal-burn">0</strong>
                                </div>
                            </div>
                        </div>
                        <div class="macros-container">
                            <div class="macro-card">
                                <div class="macro-head">
                                    <span><span data-i18n="carbs">碳水化合物</span></span>
                                    <strong id="macro-carbs-txt">0 / 300g</strong>
                                </div>
                                <div class="macro-bar-bg"><div id="bar-carbs" class="macro-bar-fill carbs" style="width: 0%"></div></div>
                            </div>
                            <div class="macro-card">
                                <div class="macro-head">
                                    <span><span data-i18n="protein">蛋白質</span></span>
                                    <strong id="macro-protein-txt">0 / 160g</strong>
                                </div>
                                <div class="macro-bar-bg"><div id="bar-protein" class="macro-bar-fill protein" style="width: 0%"></div></div>
                            </div>
                            <div class="macro-card">
                                <div class="macro-head">
                                    <span><span data-i18n="fat">脂肪</span></span>
                                    <strong id="macro-fat-txt">0 / 75g</strong>
                                </div>
                                <div class="macro-bar-bg"><div id="bar-fat" class="macro-bar-fill fat" style="width: 0%"></div></div>
                            </div>
                        </div>
                    </div>
                    <div class="meals-grid">
                        <div class="meal-card">
                            <div class="meal-header">
                                <div class="meal-title">
                                    <i class="fas fa-hamburger" style="color:var(--primary);"></i> 
                                    <h3><span data-i18n="mealTitle">餐點紀錄列表</span></h3>
                                </div>
                                <span class="meal-total" id="meal-total-kcal">0 kcal</span>
                            </div>
                            <div class="food-list" id="lunch-list"></div>
                        </div>
                        <div class="water-card" onclick="handleWaterClick(event, this)">
                            <div class="water-header">
                                <h3><i class="fas fa-tint" style="color:#00bcd4;"></i> <span data-i18n="waterTitle">水分攝取</span></h3>
                                <span id="water-count-txt">0 / 2500 ml</span>
                            </div>
                            <div class="water-grid" id="water-cups-container"></div>
                        </div>
                    </div>
                </section>

                <section id="stats" class="page">
                    <div class="section-header-lg">
                        <h2 class="gradient-text"><span data-i18n="statsTitle">數據與成就</span></h2>
                        <p class="meta-desc-lg"><span data-i18n="statsSub">持續記錄，看見成長軌跡</span></p>
                    </div>
                    <div class="today-stats-grid">
                        <div class="stats-main-panel today-summary-card">
                            <div class="panel-head">
                                <h3><i class="fas fa-calendar-check"></i> <span data-i18n="statsToday">今日身體狀態</span></h3>
                                <button class="ai-scan-btn" onclick="openModal('body-input-modal')">
                                    <i class="fas fa-edit"></i> <span data-i18n="statsUpdate">更新數據</span>
                                </button>
                            </div>
                            <div class="today-data-display">
                                <div class="data-item">
                                    <span class="lbl" data-i18n="statsWeight">體重</span>
                                    <strong id="display-weight">-- <small>kg</small></strong>
                                </div>
                                <div class="data-item">
                                    <span class="lbl" data-i18n="statsFat">體脂</span>
                                    <strong id="display-fat">-- <small>%</small></strong>
                                </div>
                                <div class="data-item">
                                    <span class="lbl" data-i18n="statsMuscle">骨骼肌</span>
                                    <strong id="display-muscle">-- <small>kg</small></strong>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="stats-showcase-grid">
                        <div class="stats-main-panel">
                            <div class="panel-head">
                                <h3><i class="fas fa-chart-area"></i> <span data-i18n="statsWeightTrend">體重變化趨勢</span></h3>
                                <div class="time-filter-modern" id="weight-filters">
                                    <span class="filter-btn" onclick="updateChart('3years')"><span data-i18n="f3Years">近三年</span></span>
                                    <span class="filter-btn active" onclick="updateChart('3months')"><span data-i18n="f3Month">近三月</span></span>
                                    <span class="filter-btn" onclick="updateChart('year')"><span data-i18n="fYear">今年</span></span>
                                </div>
                            </div>
                            <div class="chart-container-lg">
                                <div class="chart-y-axis">
                                    <span>70kg</span>
                                    <span>65kg</span>
                                    <span>60kg</span>
                                    <span>55kg</span>
                                </div>
                                <div class="chart-main-bars" id="weight-chart-bars"></div>
                            </div>
                        </div>
                        <div class="stats-side-panel">
                            <div class="achievement-card">
                                <i class="fas fa-fire-alt trophy-icon"></i>
                                <h4><span data-i18n="statsStreak">連續訓練紀錄</span></h4>
                                <div class="streak-days" id="streak-days-val">0 <small><span data-i18n="statsDays">天</span></small></div>
                                <p style="color:var(--primary); font-weight:bold; margin-bottom: 20px;">
                                    <span data-i18n="statsStreakSub">保持這個節奏！</span>
                                </p>
                                <button class="btn-create" id="btn-checkin" onclick="performCheckIn()">
                                    <span data-i18n="btnCheckIn">今日簽到</span>
                                </button>
                            </div>
                        </div>
                    </div>
                </section>

                <section id="settings" class="page">
                    <div class="section-header-lg">
                        <h2 class="gradient-text"><span data-i18n="setMain">設定與偏好</span></h2>
                    </div>
                    <div class="settings-wrap">
                        <div class="settings-profile-card">
                            <div class="profile-avatar">
                                <i class="fas fa-user-astronaut"></i>
                                <div class="edit-avatar-btn"><i class="fas fa-camera"></i></div>
                            </div>
                            <div class="profile-info-large">
                                <h2 id="lang-username"></h2>
                                <span class="pro-badge"><i class="fas fa-crown"></i> <span data-i18n="setPro">PRO 會員</span></span>
                                <p><span data-i18n="setJoin">加入時間: 2026年2月</span></p>
                            </div>
                        </div>
                        <div class="settings-grid">
                            <div class="settings-group custom-group">
                                <h3><i class="fas fa-sliders-h"></i> <span data-i18n="setPref">偏好設定</span></h3>
                                <div class="setting-item">
                                    <div class="set-info">
                                        <strong><span data-i18n="setGoal">健身目標</span></strong>
                                        <span><span data-i18n="setGoalSub">設定您的主要訓練目標</span></span>
                                    </div>
                                    <select id="goal-select" class="modern-select" onchange="changeGoal(this.value)">
                                        <option value="bulking" data-i18n="goalBulking">增肌</option>
                                        <option value="cutting" data-i18n="goalCutting">減脂</option>
                                        <option value="maintain" data-i18n="goalMaintain">維持</option>
                                    </select>
                                </div>
                                <div class="setting-item">
                                    <div class="set-info">
                                        <strong><span data-i18n="setLang">介面語言</span></strong>
                                        <span><span data-i18n="setLangSub">選擇應用程式顯示語言</span></span>
                                    </div>
                                    <select id="lang-select" class="modern-select">
                                        <option value="zh">繁體中文</option>
                                        <option value="en">English</option>
                                    </select>
                                </div>
                            </div>
                        </div>
                        <button class="danger-btn-modern" onclick="performLogout()">
                            <i class="fas fa-sign-out-alt"></i> <span data-i18n="setLogout">登出帳號</span>
                        </button>
                    </div>
                </section>
            </div>
        </main>

        <div id="steps-settings-modal" class="modal-overlay" onclick="closeModal(event, 'steps-settings-modal')">
            <div class="modal-content">
                <div class="modal-header">
                    <h3>步數目標設定</h3>
                    <i class="fas fa-times close-btn" onclick="closeModal(event, 'steps-settings-modal')"></i>
                </div>
                <div class="modal-body">
                    <div class="input-group">
                        <label>今日步數</label>
                        <input type="number" id="input-steps-now">
                    </div>
                    <div class="input-group">
                        <label>目標步數</label>
                        <input type="number" id="input-steps-goal">
                    </div>
                </div>
                <div class="modal-footer">
                    <button class="btn-cancel" onclick="document.getElementById('steps-settings-modal').style.display='none'">
                        <span data-i18n="btnCancel">取消</span>
                    </button>
                    <button class="btn-create" onclick="saveStepsSettings()">
                        <span data-i18n="btnSave">儲存</span>
                    </button>
                </div>
            </div>
        </div>

        <div id="cal-goal-modal" class="modal-overlay" onclick="closeModal(event, 'cal-goal-modal')">
            <div class="modal-content">
                <div class="modal-header">
                    <h3>飲食與營養目標設定</h3>
                    <i class="fas fa-times close-btn" onclick="closeModal(event, 'cal-goal-modal')"></i>
                </div>
                <div class="modal-body">
                    <div class="input-group">
                        <label>每日總熱量目標 (kcal)</label>
                        <input type="number" id="input-cal-goal">
                    </div>
                    <div class="input-grid">
                        <div class="input-group">
                            <label>碳水 (g)</label>
                            <input type="number" id="input-carbs-goal">
                        </div>
                        <div class="input-group">
                            <label>蛋白 (g)</label>
                            <input type="number" id="input-protein-goal">
                        </div>
                    </div>
                </div>
                <div class="modal-footer">
                    <button class="btn-cancel" onclick="document.getElementById('cal-goal-modal').style.display='none'">
                        <span data-i18n="btnCancel">取消</span>
                    </button>
                    <button class="btn-create" onclick="saveCalSettings()">
                        <span data-i18n="btnSave">儲存</span>
                    </button>
                </div>
            </div>
        </div>

        <div id="activity-input-modal" class="modal-overlay" onclick="closeModal(event, 'activity-input-modal')">
            <div class="modal-content">
                <div class="modal-header">
                    <h3><span data-i18n="dietActivity">新增運動消耗</span></h3>
                    <i class="fas fa-times close-btn" onclick="closeModal(event, 'activity-input-modal')"></i>
                </div>
                <div class="modal-body">
                    <div class="input-group">
                        <label>預設運動類型</label>
                        <select id="preset-activity" class="modern-select" onchange="updatePresetBurn(this.value)">
                            <option value="0">選擇運動類型...</option>
                            <option value="450">重量訓練 (1小時)</option>
                            <option value="600">跑步 (1小時)</option>
                            <option value="300">快走 (1小時)</option>
                            <option value="500">游泳 (1小時)</option>
                            <option value="400">自行車 (1小時)</option>
                        </select>
                    </div>
                    <div class="input-group">
                        <label>自訂熱量 (kcal)</label>
                        <input type="number" id="input-burn-kcal" placeholder="手動輸入消耗熱量">
                    </div>
                </div>
                <div class="modal-footer">
                    <button class="btn-cancel" onclick="document.getElementById('activity-input-modal').style.display='none'">
                        <span data-i18n="btnCancel">取消</span>
                    </button>
                    <button class="btn-create" onclick="saveActivity()">
                        <span data-i18n="btnSave">新增消耗</span>
                    </button>
                </div>
            </div>
        </div>

        <div id="body-input-modal" class="modal-overlay" onclick="closeModal(event, 'body-input-modal')">
    <div class="modal-content">
        <div class="modal-header"><h3 data-i18n="statsUpdateTitle">紀錄今日數據與目標</h3><i class="fas fa-times close-btn" onclick="closeModal(event, 'body-input-modal')"></i></div>
        <div class="modal-body">
            <div class="input-group"><label>身高 (cm)</label><input type="number" id="input-height" step="0.1"></div>
            
            <div class="input-group"><label data-i18n="statsWeight">體重 (kg)</label><input type="number" id="input-weight" step="0.1"></div>
            <div class="input-group"><label>目標體重 (kg)</label><input type="number" id="input-weight-goal" step="0.1"></div>
            <div class="input-group"><label data-i18n="statsFat">體脂肪 (%)</label><input type="number" id="input-fat" step="0.1"></div>
            <div class="input-group"><label data-i18n="statsMuscle">骨骼肌重 (kg)</label><input type="number" id="input-muscle" step="0.1"></div>
        </div>
                <div class="modal-body">
                    <div class="input-group">
                        <label data-i18n="statsWeight">體重 (kg)</label>
                        <input type="number" id="input-weight" step="0.1">
                    </div>
                    <div class="input-group">
                        <label>目標體重 (kg)</label>
                        <input type="number" id="input-weight-goal" step="0.1">
                    </div>
                    <div class="input-group">
                        <label data-i18n="statsFat">體脂肪 (%)</label>
                        <input type="number" id="input-fat" step="0.1">
                    </div>
                    <div class="input-group">
                        <label data-i18n="statsMuscle">骨骼肌重 (kg)</label>
                        <input type="number" id="input-muscle" step="0.1">
                    </div>
                </div>
                <div class="modal-footer">
                    <button class="btn-cancel" onclick="document.getElementById('body-input-modal').style.display='none'">
                        <span data-i18n="btnCancel">取消</span>
                    </button>
                    <button class="btn-create" onclick="saveBodyStats()">
                        <span data-i18n="btnSave">儲存數據</span>
                    </button>
                </div>
            </div>
        </div>

        <div id="countdown-settings-modal" class="modal-overlay" onclick="closeModal(event, 'countdown-settings-modal')">
            <div class="modal-content">
                <div class="modal-header">
                    <h3><span data-i18n="mCountTitle">自訂倒數事件</span></h3>
                    <i class="fas fa-times close-btn" onclick="closeModal(event, 'countdown-settings-modal')"></i>
                </div>
                <div class="modal-body">
                    <div class="input-group">
                        <label><span data-i18n="mCountName">事件名稱</span></label>
                        <input type="text" id="custom-event-name" data-i18n="mCountNameP" placeholder="例如: 2026 統測">
                    </div>
                    <div class="input-group">
                        <label><span data-i18n="mCountDate">目標日期</span></label>
                        <input type="date" id="custom-event-date">
                    </div>
                </div>
                <div class="modal-footer">
                    <button class="btn-cancel" onclick="document.getElementById('countdown-settings-modal').style.display='none'">
                        <span data-i18n="btnCancel">取消</span>
                    </button>
                    <button class="btn-create" onclick="saveCountdownSettings()">
                        <span data-i18n="btnSave">儲存設定</span>
                    </button>
                </div>
            </div>
        </div>

        <div id="ai-scan-modal" class="modal-overlay" onclick="closeModal(event, 'ai-scan-modal')">
            <div class="modal-content ai-modal-content">
                <div class="modal-header">
                    <h3><i class="fas fa-robot text-primary"></i> <span data-i18n="mAiTitle">AI 智能食物辨識</span></h3>
                    <i class="fas fa-times close-btn" onclick="closeModal(event, 'ai-scan-modal')"></i>
                </div>
                <div class="modal-body ai-body">
                    <div class="image-upload-area" onclick="document.getElementById('file-input').click()">
                        <div class="upload-placeholder" id="upload-placeholder">
                            <i class="fas fa-cloud-upload-alt" style="font-size:30px;"></i>
                            <p><span data-i18n="mAiUpload">點擊或拖曳上傳食物照片</span></p>
                            <span>已掛載: best.keras / labels.txt</span>
                        </div>
                        <img id="food-preview" class="food-preview" style="display:none;">
                        <div class="scanner-laser" id="scanner-laser" style="display:none;"></div>
                    </div>
                    <input type="file" id="file-input" accept="image/*" style="display:none;" onchange="previewImage(event)">
                    <div class="ai-result-area" id="ai-result-area" style="display:none;">
                        <h4 class="scan-status" id="scan-status"><span data-i18n="mAiStatus">分析中...</span></h4>
                        <div class="detected-food">
                            <span class="label"><span data-i18n="mAiResult">辨識結果:</span></span>
                            <strong id="ai-food-name">--</strong>
                        </div>
                        <div class="detected-macros">
                            <span id="ai-food-cal">-- kcal</span>
                        </div>
                    </div>
                </div>
                <div class="modal-footer">
                    <button class="btn-cancel" onclick="document.getElementById('ai-scan-modal').style.display='none'">
                        <span data-i18n="btnCancel">取消</span>
                    </button>
                    <button class="btn-create ai-analyze-btn" id="ai-analyze-btn" disabled onclick="startAIScan()">
                        <span data-i18n="mAiBtn">啟動推論模型</span>
                    </button>
                    <button class="btn-create" id="ai-add-btn" style="display:none;" onclick="addScannedFood()">
                        <span data-i18n="mAiAddBtn">加入飲食紀錄</span>
                    </button>
                </div>
            </div>
        </div>

        <div id="manual-food-modal" class="modal-overlay" onclick="closeModal(event, 'manual-food-modal')">
            <div class="modal-content">
                <div class="modal-header">
                    <h3><i class="fas fa-pen text-primary"></i> <span data-i18n="mManTitle">手動輸入食物</span></h3>
                    <i class="fas fa-times close-btn" onclick="closeModal(event, 'manual-food-modal')"></i>
                </div>
                <div class="modal-body">
                    <div class="input-group">
                        <label><span data-i18n="mManName">食物名稱</span></label>
                        <input type="text" id="manual-name" data-i18n="mManNameP" placeholder="例如: 雞胸肉沙拉">
                    </div>
                    <div class="input-grid">
                        <div class="input-group">
                            <label><span data-i18n="mManKcal">熱量 (kcal)</span></label>
                            <input type="number" id="manual-kcal" placeholder="0" min="0">
                        </div>
                        <div class="input-group">
                            <label><span data-i18n="mManCarbs">碳水 (g)</span></label>
                            <input type="number" id="manual-carbs" placeholder="0" min="0">
                        </div>
                        <div class="input-group">
                            <label><span data-i18n="mManPro">蛋白質 (g)</span></label>
                            <input type="number" id="manual-protein" placeholder="0" min="0">
                        </div>
                        <div class="input-group">
                            <label><span data-i18n="mManFat">脂肪 (g)</span></label>
                            <input type="number" id="manual-fat" placeholder="0" min="0">
                        </div>
                    </div>
                </div>
                <div class="modal-footer">
                    <button class="btn-cancel" onclick="document.getElementById('manual-food-modal').style.display='none'">
                        <span data-i18n="btnCancel">取消</span>
                    </button>
                    <button class="btn-create" onclick="saveManualFood()">
                        <span data-i18n="mManAddBtn">加入紀錄</span>
                    </button>
                </div>
            </div>
        </div>

        <div id="custom-plan-modal" class="modal-overlay" onclick="closeModal(event, 'custom-plan-modal')">
            <div class="modal-content" style="width: 500px; max-height: 90vh; overflow-y: auto;">
                <div class="modal-header">
                    <h3><span data-i18n="mPlanTitle">建立新訓練計畫</span></h3>
                    <i class="fas fa-times close-btn" onclick="closeModal(event, 'custom-plan-modal')"></i>
                </div>
                <div class="modal-body">
                    <div class="input-group">
                        <label><span data-i18n="mPlanName">計畫名稱</span></label>
                        <input type="text" id="plan-name" data-i18n="mPlanNameP" placeholder="例如: 腿部加強...">
                    </div>
                    <div class="input-group">
                        <label><span data-i18n="mPlanIcon">選擇封面圖標</span></label>
                        <div class="icon-selector">
                            <img src="./Leg day.png" class="preset-icon active" onclick="selectPresetIcon(this, './Leg day.png')" onerror="this.src='./custom.jpg'">
                            <img src="./Chest day.png" class="preset-icon" onclick="selectPresetIcon(this, './Chest day.png')" onerror="this.src='./custom.jpg'">
                            <img src="./Back day.png" class="preset-icon" onclick="selectPresetIcon(this, './Back day.png')" onerror="this.src='./custom.jpg'">
                            <img src="./Shoulder day.png" class="preset-icon" onclick="selectPresetIcon(this, './Shoulder day.png')" onerror="this.src='./custom.jpg'">
                            <img src="./Arm day.png" class="preset-icon" onclick="selectPresetIcon(this, './Arm day.png')" onerror="this.src='./custom.jpg'">
                            <div class="local-icon-upload" onclick="document.getElementById('plan-icon-upload').click()">
                                <i class="fas fa-upload"></i>
                            </div>
                            <input type="file" id="plan-icon-upload" style="display:none;" accept="image/*" onchange="previewPlanIcon(event)">
                        </div>
                    </div>
                    <div class="input-group">
                        <label><span data-i18n="mPlanExList">自訂動作清單</span></label>
                        <div id="custom-ex-list"></div>
                        <div class="add-ex-form">
                            <input type="text" id="ex-name" data-i18n="mPlanExName" placeholder="動作名稱 (例: 槓鈴深蹲)">
                            <input type="text" id="ex-meta" data-i18n="mPlanExMeta" placeholder="組數/重量 (例: 4組x12次 | 50kg)">
                            <input type="text" id="ex-desc" data-i18n="mPlanExDesc" placeholder="目標肌群 (例: 股四頭肌)">
                            <button onclick="addCustomExToList()">
                                <i class="fas fa-plus"></i> 
                                <span data-i18n="mPlanExAddBtn">新增動作</span>
                            </button>
                        </div>
                    </div>
                </div>
                <div class="modal-footer">
                    <button class="btn-cancel" onclick="document.getElementById('custom-plan-modal').style.display='none'">
                        <span data-i18n="btnCancel">取消</span>
                    </button>
                    <button class="btn-create" onclick="saveCustomPlan()">
                        <span data-i18n="btnCreate">建立計畫</span>
                    </button>
                </div>
            </div>
        </div>
    </div>
    <script src="script.js"></script>
</body>
</html>
